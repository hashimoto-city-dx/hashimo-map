<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8' />
  <title>橋本市「Hashi-Mo」加盟店一覧(非公式)</title>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, minimum-scale=1.0'>
  <meta name='apple-mobile-web-app-capable' content='yes'>
  <link rel="stylesheet" href="css/style_menu.css">
  <script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
  <script src='http://d3js.org/d3.v3.min.js" charset="utf-8'></script>
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v3.1.0/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v3.1.0/mapbox-gl.css' rel='stylesheet' />
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 55px;
      bottom: 0;
      width: 100%;
    }
  </style>

  <header id="global-head">
    <h1 id="brand-logo">橋本市「Hashi-Mo」加盟店一覧(非公式)</h1>
    <nav class="nav">
      <ul class="nav_menu">
        <li class="nav_menu_item">最新情報は<a
            href='https://www.city.hashimoto.lg.jp/guide/sogoseisakubu/seisaku_kikaku/dejituka/index.html'
            target='_blank'>橋本市公式サイト</a>を確認ください</li>
      </ul>
    </nav>
  </header>
  <div id="nav-toggle">
    <div>
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <aside id="sidebar">
    <nav id="global-nav">
      <ul>
        <li><a href="./about.html">このページについて</a></li>
        <li><a href="https://forms.gle/Ugi8fLFNgFvk8GuM6" target='_blank'>問い合わせ</a></li>
      </ul>
    </nav>
  </aside>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>

  <script type="text/javascript">
    (function ($) {
      $(function () {
        $('.sub-menu').on({
          'mouseenter': function () {
            $(this).addClass('is-active');
          },
          'mouseleave': function () {
            $(this).removeClass('is-active');
          }
        });
        $('#nav-toggle,#overlay').on('click', function () {
          $('body').toggleClass('open');
        });
      });
    })(jQuery);
  </script>

</head>

<body>
  <!---------ヘッダー---------->
  <div id="header"></div>
  <!---------Map     ---------->
  <div id='map'></div>
  <script>
    // The value for 'accessToken' begins with 'pk...'
    mapboxgl.accessToken =
      'pk.eyJ1IjoiaGFzaGltb3RvZHgiLCJhIjoiY2x1YW9lMDFyMG43dDJub2UwZDlyYXByaSJ9.9gog1H_cjkwU_es-hAFLgg';
    const map = new mapboxgl.Map({
      container: 'map',
      // Replace YOUR_STYLE_URL with your style URL.
      style: 'mapbox://styles/hashimotodx/clv140ww9008v01q117mjcvpv',
      center: [135.563576, 34.301334],
      zoom: 10.7
    });

    // Code from the next step will go here.
    /* 
    Add an event listener that runs
      when a user clicks on the map element.
    */
    map.on('click', (event) => {
      // If the user clicked on one of your markers, get its information.
      const features = map.queryRenderedFeatures(event.point, {
        layers: ['shoplist-hashimoto-modified'] // replace with your layer name
      });
      if (!features.length) {
        return;
      }
      const feature = features[0];

      // Code from the next step will go here.

      /* 
        Create a popup, specify its options 
        and properties, and add it to the map.
      */
      const popup = new mapboxgl.Popup({
          offset: [0, -15]
        })
        .setLngLat(feature.geometry.coordinates)
        .setHTML(
          `<h3>${feature.properties.shopname}</h3>
        <p>
          <ul>
            <li>住所: ${feature.properties.address}</li>
            <li>電話番号: ${feature.properties.tel}</li>
            <li>カテゴリ: ${feature.properties.category}</li>
            <li>地元店舗分 :${feature.properties.shopgeneral}</li>
            <li>共通分 :${feature.properties.shopcommon}</li>
          <ul>
        </p>`
        )
        .addTo(map);
    });
  </script>
</body>

</html>